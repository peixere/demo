{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "height": 312,
        "id": "EnergyCollectWindow",
        "width": 523,
        "designer|userClassName": "EnergyCollectWindow",
        "designer|userAlias": "EnergyCollectWindow",
        "resizeHandles": "n",
        "layout": "border",
        "title": "数据采集"
    },
    "designerId": "a8033e9d-5a96-461f-aa0a-79587e9bd700",
    "cn": [
        {
            "type": "Ext.toolbar.Toolbar",
            "reference": {
                "name": "dockedItems",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "dock": "bottom",
                "container|pack": "end",
                "container|padding": 3,
                "id": "mytoolbar"
            },
            "designerId": "b4069205-9004-4191-a483-23838fefe3ce",
            "cn": [
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "id": "btnSave",
                        "iconCls": "icon-save",
                        "text": "保存"
                    },
                    "designerId": "1d7f2cf5-66ae-4d4c-a638-a210bfb86bb1",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onBtnSaveClick",
                                "implHandler": [
                                    "var me = this;\r",
                                    "var form = Ext.getCmp('ecform');\r",
                                    "if (form.isValid())\r",
                                    "{\r",
                                    "    form.submit(\r",
                                    "    {\r",
                                    "        url : '../EnergyCollect!save.do',\r",
                                    "        method : 'POST',\r",
                                    "        waitMsg : '正在保存数据，稍后...',\r",
                                    "        success : function(f, action)\r",
                                    "        {\r",
                                    "            Ext.Msg.alert('信息提示', '保存成功');\r",
                                    "            me.close();\r",
                                    "            var panel = Ext.getCmp('EnergyCollectPanel');\r",
                                    "            panel.onBtnSearchClick(button,e,eOpts);            \r",
                                    "        },\r",
                                    "        failure : function(f, action)\r",
                                    "        {\r",
                                    "            if(action.response.status == 200)\r",
                                    "            {\r",
                                    "                var result = Ext.JSON.decode(action.response.responseText);\r",
                                    "                Ext.Msg.alert('信息提示', result.data);\r",
                                    "            }\r",
                                    "            else\r",
                                    "            {\r",
                                    "                Ext.Msg.alert('信息提示', action.response.responseText);\r",
                                    "            }\r",
                                    "        }\r",
                                    "    });\r",
                                    "}"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "designerId": "86c90080-f567-46a7-a75e-6388c6df8745"
                        }
                    ]
                },
                {
                    "type": "Ext.button.Button",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "layout|flex": null,
                        "id": "btnReset",
                        "iconCls": "icon-close",
                        "text": "关闭"
                    },
                    "designerId": "9c49c40f-06ca-462b-be2c-b9bbff63d9c9",
                    "cn": [
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onBtnResetClick",
                                "implHandler": [
                                    "this.close();"
                                ],
                                "name": "click",
                                "scope": "me"
                            },
                            "designerId": "c95fb61c-e8a3-4913-9c2f-2bfafe302c56"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "layout|region": "center",
                "id": "ecform",
                "layout": "column",
                "bodyPadding": 10,
                "title": null
            },
            "designerId": "cf418c28-e090-41d3-8bbd-4147d2aa6c98",
            "cn": [
                {
                    "type": "Ext.form.field.Text",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "id": "building.name",
                        "padding": 2,
                        "fieldLabel": "建筑名称",
                        "labelAlign": "right",
                        "name": "name",
                        "readOnly": true
                    },
                    "designerId": "1da0ceb4-bdec-40c2-ba15-ebd4b65ca5c9"
                },
                {
                    "type": "Ext.form.field.Hidden",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "id": "building.id",
                        "width": 150,
                        "fieldLabel": "Label",
                        "name": "buildingId"
                    },
                    "designerId": "e5679219-69f5-4b73-9f02-30e2e2adce6a"
                },
                {
                    "type": "Ext.form.field.Date",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "id": "collectDate",
                        "padding": 2,
                        "width": null,
                        "fieldLabel": "采集时间",
                        "labelAlign": "right",
                        "name": "collectDate",
                        "value": 1385827200000,
                        "useStrict": null
                    },
                    "designerId": "83c6df16-9024-4882-91f0-ac04c5747f13",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "renderer",
                            "type": "string"
                        }
                    ]
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "electric",
                        "padding": 2,
                        "fieldLabel": "电",
                        "labelAlign": "right",
                        "name": "electric"
                    },
                    "designerId": "b18407aa-5d46-4379-85e6-4a3fe76f097b"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "water",
                        "padding": 2,
                        "fieldLabel": "水",
                        "labelAlign": "right",
                        "name": "water"
                    },
                    "designerId": "c2ea176d-8a97-4a4f-9333-b7589a835115"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "gas",
                        "padding": 2,
                        "fieldLabel": "燃气",
                        "labelAlign": "right",
                        "name": "gas"
                    },
                    "designerId": "544146cb-4610-4619-8905-b5fb11c9f4ad"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "heating",
                        "padding": 2,
                        "fieldLabel": "集中供热量",
                        "labelAlign": "right",
                        "name": "heating"
                    },
                    "designerId": "1b7e5de1-ac75-4a97-9364-c0c248b26038"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "otherEnergy",
                        "padding": 2,
                        "fieldLabel": "其它能源",
                        "labelAlign": "right",
                        "name": "otherEnergy"
                    },
                    "designerId": "ed451fc9-89ec-4d04-969e-0d94db06ea6b"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "coal",
                        "padding": 2,
                        "fieldLabel": "煤",
                        "labelAlign": "right",
                        "name": "coal"
                    },
                    "designerId": "a845a483-d6d1-43f6-bafb-d1ba114782bd"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "lpg",
                        "padding": 2,
                        "fieldLabel": " 液化石油气",
                        "labelAlign": "right",
                        "name": "lpg"
                    },
                    "designerId": "b1b616d1-f560-4c60-841c-afc31c2b14fa"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "manufacturedGas",
                        "padding": 2,
                        "fieldLabel": "人工煤气",
                        "labelAlign": "right",
                        "name": "manufacturedGas"
                    },
                    "designerId": "a4a598a2-026d-454c-8c56-7d85e11f0703"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "gasoline",
                        "padding": 2,
                        "fieldLabel": "汽油",
                        "labelAlign": "right",
                        "name": "gasoline"
                    },
                    "designerId": "9d208ad7-3746-4470-8d66-6121fb4e71ed"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "kerosene",
                        "padding": 2,
                        "fieldLabel": "煤油",
                        "labelAlign": "right",
                        "name": "kerosene"
                    },
                    "designerId": "f4496c49-df6f-4ce6-bf06-7a33e5603900"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "solarThermal",
                        "padding": 2,
                        "fieldLabel": "太阳能光热利用系统集热器面积",
                        "labelAlign": "right",
                        "name": "solarThermal"
                    },
                    "designerId": "c2469947-880f-49dd-a126-cd467525a94a"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "geothermal",
                        "padding": 2,
                        "fieldLabel": "浅层地热能利用系统装机容量",
                        "labelAlign": "right",
                        "name": "geothermal"
                    },
                    "designerId": "421ee246-465d-4f09-b209-569cd72d66e3"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "geothermalAuxiliary",
                        "padding": 2,
                        "fieldLabel": "浅层地热能利用系统辅助热源供热量",
                        "labelAlign": "right",
                        "name": "geothermalAuxiliary"
                    },
                    "designerId": "06cdd2f5-4504-4c81-a5f2-fb4fb047bbbe"
                },
                {
                    "type": "Ext.form.field.Number",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "height": null,
                        "id": "solarPV",
                        "padding": 2,
                        "fieldLabel": "太阳能光电利用系统装机容量",
                        "labelAlign": "right",
                        "name": "solarPV"
                    },
                    "designerId": "e41abcc5-10e4-4c95-94f0-c98b1d44dd0b"
                },
                {
                    "type": "Ext.form.field.Hidden",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "id": "id",
                        "fieldLabel": "Label",
                        "name": "id"
                    },
                    "designerId": "f0deafc2-9abc-4be5-b76e-d2d792f62112"
                }
            ]
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "bindFields",
                "designer|params": [
                    "buildingId",
                    "buildingName",
                    "id"
                ],
                "implHandler": [
                    "var me = this;\r",
                    "var formPanel = Ext.getCmp('ecform');\r",
                    "Ext.getCmp('building.id').setValue(buildingId);\r",
                    "Ext.getCmp('building.name').setValue(buildingName);\r",
                    "var wait = Ext.Msg.wait(\"正在载入......\", \"操作提示\");\r",
                    "Ext.Ajax.request(\r",
                    "{\r",
                    "    url : '../EnergyCollect.do',\r",
                    "    method : 'POST',\r",
                    "    params:{  \r",
                    "        id:id,\r",
                    "        buildingId:buildingId\r",
                    "    },  \r",
                    "    success : function(response, options)\r",
                    "    {\r",
                    "        wait.close();\r",
                    "        var result = Ext.JSON.decode(response.responseText); \r",
                    "        if(result.success)\r",
                    "        {\r",
                    "            var record = Ext.create('ems.model.EnergyConsumptionCollectModel');\r",
                    "            record.data = result.data;\r",
                    "            formPanel.loadRecord(record);  \r",
                    "            Ext.getCmp('collectDate').setValue(new Date(record.data.collectDate.time));\r",
                    "            Ext.getCmp('building.id').setValue(result.data.building.id);\r",
                    "        }\r",
                    "        else\r",
                    "        {\r",
                    "            me.close();\r",
                    "            Ext.Msg.alert('信息提示', result.data);\r",
                    "        }\r",
                    "    },\r",
                    "    failure : function(response, options)\r",
                    "    {\r",
                    "        wait.close();\r",
                    "        me.close();\r",
                    "        if(response.status == 200)\r",
                    "        {\r",
                    "            var result = Ext.JSON.decode(response.responseText);\r",
                    "            Ext.Msg.alert('信息提示', result.data);\r",
                    "        }\r",
                    "        else\r",
                    "        {\r",
                    "            Ext.Msg.alert('信息提示', response.responseText);\r",
                    "        }\r",
                    "    }\r",
                    "});"
                ]
            },
            "designerId": "5834f8af-e89c-4d45-8f30-7815dda80826"
        }
    ]
}