<!DOCTYPE html>
<html>
<head>
<title>index</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="resources/favicon.ico" />
<link type="text/css" rel="stylesheet" href="resources/portal.css">
<script type="text/javascript">
    //var ctx = "";
</script>
<!-- 
	<link type="text/css" rel="stylesheet" href="http://cdn.sencha.com/ext/gpl/4.2.1/resources/css/ext-all.css">
    <link type="text/css" rel="stylesheet" href="http://cdn.sencha.com/ext/gpl/4.2.1/resources/ext-theme-access/ext-theme-access-all.css">
    
    <script type="text/javascript" src="http://cdn.sencha.com/ext/gpl/4.2.1/ext-all.js"></script>
    <script type="text/javascript" src="http://cdn.sencha.com/ext/gpl/4.2.1/locale/ext-lang-zh_CN.js"></script>
    -->
<!-- <x-bootstrap> -->
<script type="text/javascript"
	src="ext4/shared/include-ext.js?theme=access"></script>

<!-- </x-bootstrap> -->
<script type="text/javascript" src="ext4/commons.js"></script>
<script type="text/javascript" src="ext4/portal.js"></script>
<script type="text/javascript">
Ext.require([
             'Ext.form.*',
             'Ext.data.*',
             'Ext.tip.QuickTipManager'
         ]);
    Ext.onReady(function()
    {
	Ext.QuickTips.init();

	    Ext.define('Employee', {
	        extend: 'Ext.data.Model',
	        fields: [
	            {name: 'email',     type: 'string'},
	            {name: 'title',     type: 'string'},
	            {name: 'firstName', type: 'string'},
	            {name: 'lastName',  type: 'string'},
	            {name: 'phone-1',   type: 'string'},
	            {name: 'phone-2',   type: 'string'},
	            {name: 'phone-3',   type: 'string'},
	            {name: 'hours',     type: 'number'},
	            {name: 'minutes',   type: 'number'},
	            {name: 'startDate', type: 'date'},
	            {name: 'endDate',   type: 'date'}
	        ]
	    });

	    var form = Ext.create('Ext.form.Panel', {
	        //renderTo: 'docbody',
	        title   : 'FieldContainers',
			//region : 'center',
			//buttonAlign:'center' ,  
	        autoHeight: true,
	        //width   : 600,
	        padding: 20,
	        bodyPadding: 10,
	        defaults: {
	            labelAlign: 'right',
	            anchor: '100%',
	            labelWidth: 100
	        },
	        items   : [
	            {
	                xtype     : 'textfield',
	                name      : 'email',
	                fieldLabel: 'Email Address',
	                vtype: 'email',
	                msgTarget: 'side',
	                allowBlank: false
	            },
	            {
	                xtype: 'fieldcontainer',
	                fieldLabel: 'Date Range',
	                combineErrors: true,
	                msgTarget : 'side',
	                layout: 'hbox',
	                defaults: {
	                    flex: 1,
	                    hideLabel: true
	                },
	                items: [
	                    {
	                        xtype     : 'datefield',
	                        name      : 'startDate',
	                        fieldLabel: 'Start',
	                        margin: '0 5 0 0',
	                        allowBlank: false
	                    },
	                    {
	                        xtype     : 'datefield',
	                        name      : 'endDate',
	                        fieldLabel: 'End',
	                        allowBlank: false
	                    }
	                ]
	            },
	            {
	                xtype: 'fieldset',
	                title: 'Details',
	                collapsible: true,
	                defaults: {
	                    labelAlign: 'right',
	                    labelWidth: 89,
	                    anchor: '100%',
	                    layout: {
	                        type: 'hbox',
	                        defaultMargins: {top: 0, right: 5, bottom: 0, left: 0}
	                    }
	                },
	                items: [
	                    {
	                        xtype: 'fieldcontainer',
	                        fieldLabel: 'Phone',
	                        combineErrors: true,
	                        msgTarget: 'under',
	                        defaults: {
	                            hideLabel: true
	                        },
	                        items: [
	                            {xtype: 'displayfield', value: '('},
	                            {xtype: 'textfield',    fieldLabel: 'Phone 1', name: 'phone-1', width: 35, allowBlank: false},
	                            {xtype: 'displayfield', value: ')'},
	                            {xtype: 'textfield',    fieldLabel: 'Phone 2', name: 'phone-2', width: 35, allowBlank: false, margins: '0 5 0 0'},
	                            {xtype: 'displayfield', value: '-'},
	                            {xtype: 'textfield',    fieldLabel: 'Phone 3', name: 'phone-3', width: 48, allowBlank: false}
	                        ]
	                    },
	                    {
	                        xtype: 'fieldcontainer',
	                        fieldLabel: 'Time worked',
	                        combineErrors: false,
	                        defaults: {
	                            hideLabel: true
	                        },
	                        items: [
	                           {
	                               name : 'hours',
	                               xtype: 'numberfield',
	                               width: 50,
	                               allowBlank: false
	                           },
	                           {
	                               xtype: 'displayfield',
	                               value: 'hours'
	                           },
	                           {
	                               name : 'minutes',
	                               xtype: 'numberfield',
	                               width: 50,
	                               allowBlank: false
	                           },
	                           {
	                               xtype: 'displayfield',
	                               value: 'mins'
	                           }
	                        ]
	                    },
	                    {
	                        xtype : 'fieldcontainer',
	                        combineErrors: true,
	                        msgTarget: 'side',
	                        fieldLabel: 'Full Name',
	                        defaults: {
	                            hideLabel: true
	                        },
	                        items : [
	                            {
	                                //the width of this field in the HBox layout is set directly
	                                //the other 2 items are given flex: 1, so will share the rest of the space
	                                width:          65,

	                                xtype:          'combo',
	                                queryMode:      'local',
	                                value:          'mrs',
	                                triggerAction:  'all',
	                                forceSelection: true,
	                                editable:       false,
	                                fieldLabel:     'Title',
	                                name:           'title',
	                                displayField:   'name',
	                                valueField:     'value',
	                                store:          Ext.create('Ext.data.Store', {
	                                    fields : ['name', 'value'],
	                                    data   : [
	                                        {name : 'Mr',   value: 'mr'},
	                                        {name : 'Mrs',  value: 'mrs'},
	                                        {name : 'Miss', value: 'miss'}
	                                    ]
	                                })
	                            },
	                            {
	                                xtype: 'textfield',
	                                flex : 1,
	                                name : 'firstName',
	                                fieldLabel: 'First',
	                                allowBlank: false
	                            },
	                            {
	                                xtype: 'textfield',
	                                flex : 1,
	                                name : 'lastName',
	                                fieldLabel: 'Last',
	                                allowBlank: false
	                            }
	                        ]
	                    }
	                ]
	            }
	        ],
	        buttons: [
	            {
	                text   : 'Load test data',
	                handler: function() {
	                    this.up('form').getForm().loadRecord(Ext.create('Employee', {
	                        'email'    : 'abe@sencha.com',
	                        'title'    : 'mr',
	                        'firstName': 'Abraham',
	                        'lastName' : 'Elias',
	                        'startDate': '01/10/2003',
	                        'endDate'  : '12/11/2009',
	                        'phone-1'  : '555',
	                        'phone-2'  : '123',
	                        'phone-3'  : '4567',
	                        'hours'    : 7,
	                        'minutes'  : 15
	                    }));
	                }
	            },
	            {
	                text   : 'Save',
	                handler: function() {
	                    var form   = this.up('form').getForm(),
	                        encode = Ext.String.htmlEncode,
	                        s      = '';

	                    if (form.isValid()) {
	                        Ext.iterate(form.getValues(), function(key, value) {
	                            value = encode(value);
	                            
	                            s += Ext.util.Format.format("{0} = {1}<br />", key, value);
	                        }, this);

	                        Ext.Msg.alert('Form Values', s);
	                    }
	                }
	            },

	            {
	                text   : 'Reset',
	                handler: function() {
	                    this.up('form').getForm().reset();
	                }
	            }
	        ]
	    });	
	var portal = Ext.create('Portal');
	function menuClick(view, node)
	{
	    //alert(view.id + node.data.text);
	    //portal.content.setTitle(node.data.text);
	    form.setTitle(node.data.text);
	    tree.root.reload();
	    //portal.content.update(node.data.text);
	}
	var selectNode = null;
	var contextmenu = Ext.create("Ext.menu.Menu",
	{
	    id : 'Menu',
	    items : [
	    {
			text : '查看',
			iconCls : 'icon-note',
			handler : function(node, e)
			{
			    alert(selectNode.data.text);
			}
	    },
	    {
			text : '修改',
			iconCls : 'icon-edit',
			handler : function(node, e)
			{
			    alert(selectNode.data.text);
			}
    	},
	    {
			text : '删除',
			iconCls : 'icon-del',
			handler : function(node, e)
			{
			    alert(selectNode.data.text);
			}
	    }
	    ]
	});

	    var tree = Ext.create("Ext.tree.TreePanel",
	    {            
			id : 'tree',
			title : '菜单管理',
			region : 'west',
			width : 250,
			minWidth : 100,
			maxWidth : 400,
			height : 200,
			animate:true,  
            border:false,  
            bodyborder:false,  
            lines:true, 			
			split : true,
			stateful : true,
            collapsible:true,  
            frame:false,  
            enableDD:true,  
            autoScroll:true,  
            autoHeight:false,
			rootVisible : false,
			store : treeStore('p/right!tree.do'),
			listeners :
			{
			    render : function()
			    {
					Ext.getBody().on("contextmenu", Ext.emptyFn, null,
					{
					    preventDefault : true
					});
				},
			    itemclick : function(view, node)
			    {
					menuClick(view, node);
			    },				
			    itemcontextmenu : function(grid, record, item, index, event)
			    {
					selectNode = record;
					contextmenu.showAt(event.getXY());
					//alert(record.data.text);
			    }
		}
	    });
	    portal.center.add(tree);
	    portal.center.doLayout();
	
	//loadTree('main.do?action=menu', '菜单管理');
	//portal.content.setTitle('内容');
	portal.content.add(form);
	
    });
</script>
</head>
<body>
</body>
</html>