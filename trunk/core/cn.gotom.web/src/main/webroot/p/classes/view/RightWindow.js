/*
 * File: classes/view/RightWindow.js
 *
 * This file was generated by Sencha Architect version 2.2.3.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 4.2.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 4.2.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Gotom.view.RightWindow', {
    extend: 'Ext.window.Window',

    form: '',
    height: 350,
    maxWidth: 400,
    minHeight: 350,
    minWidth: 400,
    width: 400,
    layout: {
        type: 'border'
    },
    manageHeight: false,
    title: '菜单编辑',
    titleCollapse: false,
    modal: true,

    initComponent: function() {
        var me = this;

        Ext.applyIf(me, {
            dockedItems: [
                {
                    xtype: 'toolbar',
                    dock: 'bottom',
                    layout: {
                        pack: 'end',
                        type: 'hbox'
                    },
                    items: [
                        {
                            xtype: 'button',
                            iconCls: 'icon-save',
                            text: '保存',
                            listeners: {
                                click: {
                                    fn: me.onButtonSaveClick,
                                    scope: me
                                }
                            }
                        }
                    ]
                }
            ],
            listeners: {
                afterlayout: {
                    fn: me.onWindowAfterLayout,
                    single: true,
                    scope: me
                }
            }
        });

        me.callParent(arguments);
    },

    onButtonSaveClick: function(button, e, eOpts) {
        var me = this;
        if (me.form.isValid())
        {
            me.form.submit(
            {
                url : ctxp + '/p/right!save.do',
                method : 'POST',
                waitMsg : '正在保存数据，稍后...',
                success : function(f, action)
                {
                    Ext.Msg.alert('信息提示', '保存成功');
                    me.close();
                    Ext.getCmp('RightTreePanel').getStore().reload();
                },
                failure : function(f, action)
                {
                    Ext.Msg.alert('信息提示', '保存失败！');
                }
            });
        }
    },

    onWindowAfterLayout: function(container, layout, eOpts) {
        var me = this;
        me.form = Ext.create('Ext.form.Panel',
        {
            region : 'center',
            bodyPadding : 20,
            defaults :
            {
                labelAlign : 'right',
                anchor : '100%',
                labelWidth : 100
            },
            items : [
            {
                xtype : 'hiddenfield',
                anchor : '100%',
                fieldLabel : '未节点',
                name : 'leaf'
            },
            {
                xtype : 'hiddenfield',
                anchor : '100%',
                fieldLabel : '菜单标识',
                name : 'id'
            },
            {
                xtype : 'hiddenfield',
                anchor : '100%',
                fieldLabel : '父节点标识',
                name : 'parentId'
            },
            {
                xtype : 'hiddenfield',
                anchor : '100%',
                fieldLabel : '所属应用',
                name : 'appCode'
            },
            {
                xtype : 'textfield',
                anchor : '100%',
                allowBlank : false,
                msgTarget : 'side',
                name : 'text',
                fieldLabel : '菜单名称'
            },
            {
                xtype : 'textfield',
                anchor : '100%',
                name : 'iconCls',
                fieldLabel : '图标样式'
            },
            {
                xtype : 'radiogroup',
                fieldLabel : '资源类型',
                columns : 3,
                defaults :
                {
                    name : 'type'
                },
                items : [
                {
                    inputValue : 'DIR',
                    boxLabel : '目录'
                },
                {
                    inputValue : 'URL',
                    boxLabel : '连接'
                },
                {
                    inputValue : 'COMPONENT',
                    boxLabel : '控件'
                }
                ]
            },
            {
                xtype : 'textfield',
                anchor : '100%',
                name : 'component',
                fieldLabel : '连接或控件'
            },
            {
                xtype : 'numberfield',
                anchor : '100%',
                fieldLabel : '排列顺序',
                name : 'sort'
            },
            {
                xtype : 'textareafield',
                anchor : '100%',
                name : 'resource',
                fieldLabel : '菜单资源'
            }
            ]
        });
        me.add(me.form);
    }

});